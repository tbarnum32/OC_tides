---
title: "Tides at Ocean City"
format: pdf
editor: visual
---

## Quarto

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.

## Running Code

When you click the **Render** button a document will be generated that includes both content and the output of embedded code. You can embed code like this:

```{r}
library(VulnToolkit)
library(ggplot2)
library(dplyr)
library(tswge)
library(smooth)
```

You can add options to executable code like this

```{r}
#| echo: false
OceanCity2024 <- noaa(begindate = 20240101, enddate = 20251030, 
  station = "8570283", interval = "6 minute")
```

The `echo: false` option disables the printing of code (only output is displayed). Import data from the NOAA website for Ocean City, MD in 2024.

```{r}
head(OceanCity2024)
dim(OceanCity2024)
class(OceanCity2024)

```

Initially named 2025, needs to be 2024. 2025 gave me an error about invalid time intervals, so I think the 2025 is incomplete - shows December data as 'preliminary' on the website. There are 87,840 rows of data and it is stored in a data frame, not a tibble.

```{r}
# Rename column heads for simplicity purposes
colnames(OceanCity2024) <- c("Date", "Meters", "Station")
OC.plot <- ggplot(OceanCity2024, aes(x = Date, y = Meters))+
  geom_line(color = "gray") +
  geom_point()+
  theme_bw()
OC.plot
```

I have been reading Time Series for Data Science

```{r}
#Smooth the time series data
OC.2024.ts <- structure(OceanCity2024$Meters, class = "ts")

moving_average <- function(x, n) {             # Create a function
  stats::filter(x, rep(1 / n, n), sides = 2)
}

f.hat.5 <- moving_average(OC.2024.ts, n = 5)
f.hat.100 <- moving_average(OC.2024.ts, n = 100)
OC.plot + geom_line(aes(y = f.hat), color = "blue")

OC.plot.truncated <- ggplot(OceanCity2024[1:500,], aes(x = Date, y = Meters))+
  geom_line(color = "gray") +
  geom_point()+
  theme_bw()

OC.plot.truncated + geom_line(aes(y = f.hat.5[1:500]), color = "deepskyblue") +
  geom_line(aes(y = f.hat.100[1:500]), color = "deeppink")
#OC.tides.6 <- sma(OC.2024.ts, h = 18, silent = FALSE)

```

Water measurements are taken every six minutes, so it is difficult to see how the moving average smooths the time series across almost two years. Therefore, the first two full days were plotted to visually compare moving averages wth different window sizes. The function code was modified from this [blog](https://statisticsglobe.com/moving-average-maximum-median-sum-of-time-series-in-r).
